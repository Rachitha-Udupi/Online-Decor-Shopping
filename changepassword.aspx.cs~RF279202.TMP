using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.Data.SqlClient;
using System.Windows.Forms;


public partial class changepassword : System.Web.UI.Page
{
    connect c;
    DataSet ds;
    SqlDataAdapter adp=new SqlDataAdapter ();
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Button1_Click(object sender, EventArgs e)
    {      
   
   try
{
   c=new connect();
   c .cmd .CommandText ="select * from customer where username='"+TextBox1.Text+"'";
   adp .SelectCommand =c.cmd;
   DataSet  ds=new DataSet();
    adp.Fill(ds,"cust");
       String username=ds.Tables["cust"].rows[0][3].ToString();
       String oldpassword=ds.Tables["cust"].rows[0][7].ToString();
       if(oldpassword==TextBox2.Text)
       {
            c.cmd.CommandText="update customer set password='"+TextBox3.Text+"',confirmpassword='"+ TextBox3.Text +"' where username='"+TextBox1 +"'";
           int queryStatus=c.cmd.ExecuteNonQuery();
           if(queryStatus >0)
           {
               Page .ClientScript .RegisterStartupScript (this .GetType (),"msgbox","<script>alert('Password Update sucessfully')</script>");
           }
           else 
           {
               Page .ClientScript .RegisterStartupScript (this .GetType (),"msgbox","<script>alert('Execution error')</script>");
           }
       }
         else
           {
               Page .ClientScript .RegisterStartupScript (this .GetType (),"msgbox","<script>alert('Password is not matching')</script>");
           }
     
           
       
   }
      catch(exception )
{
    throw;
}
        finally 
   {
       c.cnn.close();
   }

    
}
}
